(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[733,800],{1008:(e,t,a)=>{"use strict";a.d(t,{h:()=>l});let r="https://liase-backend-fpc8gsbrghgacdgx.centralindia-01.azurewebsites.net/api";console.log("API Configuration:",{NEXT_PUBLIC_API_URL:"https://liase-backend-fpc8gsbrghgacdgx.centralindia-01.azurewebsites.net/api",FINAL_API_URL:r});let s={BASE_URL:r},l=()=>(console.log("=== API BASE URL DEBUG ==="),console.log("Environment Variable NEXT_PUBLIC_API_URL:","https://liase-backend-fpc8gsbrghgacdgx.centralindia-01.azurewebsites.net/api"),console.log("Fallback URL:","https://liase-backend-fpc8gsbrghgacdgx.centralindia-01.azurewebsites.net/api"),console.log("Final API_CONFIG.BASE_URL:",s.BASE_URL),console.log("========================="),s.BASE_URL)},2842:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});var r=a(2115);let s=r.forwardRef(function(e,t){let{title:a,titleId:s,...l}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":s},l),a?r.createElement("title",{id:s},a):null,r.createElement("path",{fillRule:"evenodd",d:"M16.5 4.478v.227a48.816 48.816 0 0 1 3.878.512.75.75 0 1 1-.256 1.478l-.209-.035-1.005 13.07a3 3 0 0 1-2.991 2.77H8.084a3 3 0 0 1-2.991-2.77L4.087 6.66l-.209.035a.75.75 0 0 1-.256-1.478A48.567 48.567 0 0 1 7.5 4.705v-.227c0-1.564 1.213-2.9 2.816-2.951a52.662 52.662 0 0 1 3.369 0c1.603.051 2.815 1.387 2.815 2.951Zm-6.136-1.452a51.196 51.196 0 0 1 3.273 0C14.39 3.05 15 3.684 15 4.478v.113a49.488 49.488 0 0 0-6 0v-.113c0-.794.609-1.428 1.364-1.452Zm-.355 5.945a.75.75 0 1 0-1.5.058l.347 9a.75.75 0 1 0 1.499-.058l-.346-9Zm5.48.058a.75.75 0 1 0-1.498-.058l-.347 9a.75.75 0 0 0 1.5.058l.345-9Z",clipRule:"evenodd"}))})},4015:(e,t,a)=>{Promise.resolve().then(a.bind(a,5145))},5038:(e,t,a)=>{"use strict";a.d(t,{Bk:()=>c,QT:()=>d,Sk:()=>o,XI:()=>n});var r=a(5155),s=a(2115),l=a(6681);let i=(0,s.createContext)(null);function n(e){let{children:t}=e,{user:a,isAuthenticated:s}=(0,l.h)(),n=e=>!!a&&!!s&&a.role===e;return(0,r.jsx)(i.Provider,{value:{hasPermission:(e,t)=>{var r;return!!a&&!!s&&!!a.permissions&&(null==(r=a.permissions[e])?void 0:r[t])===!0},hasRole:n,isAdmin:()=>!!a&&!!s&&(n("admin")||n("superadmin")),isSuperAdmin:()=>!!a&&!!s&&n("superadmin")},children:t})}function o(){let e=(0,s.useContext)(i);if(!e)throw Error("usePermissions must be used within a PermissionProvider");return e}function c(e){let{children:t,resource:a,action:s,roles:l,fallback:i=null,requireAll:n=!1}=e;try{let{hasPermission:e,hasRole:c}=o();if(!(()=>{let t=[];return a&&s&&t.push(e(a,s)),l&&l.length>0&&(n?t.push(l.every(e=>c(e))):t.push(l.some(e=>c(e)))),0===t.length||(n?t.every(e=>e):t.some(e=>e))})())return(0,r.jsx)(r.Fragment,{children:i});return(0,r.jsx)(r.Fragment,{children:t})}catch(e){return console.warn("PermissionGate error:",e),(0,r.jsx)(r.Fragment,{children:i})}}function d(){let{hasPermission:e,hasRole:t,isAdmin:a,isSuperAdmin:r}=o();return{hasPermission:e,hasRole:t,isAdmin:a,isSuperAdmin:r,canAccess:(t,a)=>e(t,a),canManageUsers:()=>e("users","write"),canManageRoles:()=>e("roles","write"),canDeleteUsers:()=>e("users","delete"),canDeleteRoles:()=>e("roles","delete"),canViewAuditLogs:()=>e("audit","read"),canManageOrganization:()=>e("organizations","write")}}},5145:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var r=a(5155),s=a(2115);let l=s.forwardRef(function(e,t){let{title:a,titleId:r,...l}=e;return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},l),a?s.createElement("title",{id:r},a):null,s.createElement("path",{fillRule:"evenodd",d:"M12.516 2.17a.75.75 0 0 0-1.032 0 11.209 11.209 0 0 1-7.877 3.08.75.75 0 0 0-.722.515A12.74 12.74 0 0 0 2.25 9.75c0 5.942 4.064 10.933 9.563 12.348a.749.749 0 0 0 .374 0c5.499-1.415 9.563-6.406 9.563-12.348 0-1.39-.223-2.73-.635-3.985a.75.75 0 0 0-.722-.516l-.143.001c-2.996 0-5.717-1.17-7.734-3.08Zm3.094 8.016a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z",clipRule:"evenodd"}))}),i=s.forwardRef(function(e,t){let{title:a,titleId:r,...l}=e;return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},l),a?s.createElement("title",{id:r},a):null,s.createElement("path",{d:"M17.004 10.407c.138.435-.216.842-.672.842h-3.465a.75.75 0 0 1-.65-.375l-1.732-3c-.229-.396-.053-.907.393-1.004a5.252 5.252 0 0 1 6.126 3.537ZM8.12 8.464c.307-.338.838-.235 1.066.16l1.732 3a.75.75 0 0 1 0 .75l-1.732 3c-.229.397-.76.5-1.067.161A5.23 5.23 0 0 1 6.75 12a5.23 5.23 0 0 1 1.37-3.536ZM10.878 17.13c-.447-.098-.623-.608-.394-1.004l1.733-3.002a.75.75 0 0 1 .65-.375h3.465c.457 0 .81.407.672.842a5.252 5.252 0 0 1-6.126 3.539Z"}),s.createElement("path",{fillRule:"evenodd",d:"M21 12.75a.75.75 0 1 0 0-1.5h-.783a8.22 8.22 0 0 0-.237-1.357l.734-.267a.75.75 0 1 0-.513-1.41l-.735.268a8.24 8.24 0 0 0-.689-1.192l.6-.503a.75.75 0 1 0-.964-1.149l-.6.504a8.3 8.3 0 0 0-1.054-.885l.391-.678a.75.75 0 1 0-1.299-.75l-.39.676a8.188 8.188 0 0 0-1.295-.47l.136-.77a.75.75 0 0 0-1.477-.26l-.136.77a8.36 8.36 0 0 0-1.377 0l-.136-.77a.75.75 0 1 0-1.477.26l.136.77c-.448.121-.88.28-1.294.47l-.39-.676a.75.75 0 0 0-1.3.75l.392.678a8.29 8.29 0 0 0-1.054.885l-.6-.504a.75.75 0 1 0-.965 1.149l.6.503a8.243 8.243 0 0 0-.689 1.192L3.8 8.216a.75.75 0 1 0-.513 1.41l.735.267a8.222 8.222 0 0 0-.238 1.356h-.783a.75.75 0 0 0 0 1.5h.783c.042.464.122.917.238 1.356l-.735.268a.75.75 0 0 0 .513 1.41l.735-.268c.197.417.428.816.69 1.191l-.6.504a.75.75 0 0 0 .963 1.15l.601-.505c.326.323.679.62 1.054.885l-.392.68a.75.75 0 0 0 1.3.75l.39-.679c.414.192.847.35 1.294.471l-.136.77a.75.75 0 0 0 1.477.261l.137-.772a8.332 8.332 0 0 0 1.376 0l.136.772a.75.75 0 1 0 1.477-.26l-.136-.771a8.19 8.19 0 0 0 1.294-.47l.391.677a.75.75 0 0 0 1.3-.75l-.393-.679a8.29 8.29 0 0 0 1.054-.885l.601.504a.75.75 0 0 0 .964-1.15l-.6-.503c.261-.375.492-.774.69-1.191l.735.267a.75.75 0 1 0 .512-1.41l-.734-.267c.115-.439.195-.892.237-1.356h.784Zm-2.657-3.06a6.744 6.744 0 0 0-1.19-2.053 6.784 6.784 0 0 0-1.82-1.51A6.705 6.705 0 0 0 12 5.25a6.8 6.8 0 0 0-1.225.11 6.7 6.7 0 0 0-2.15.793 6.784 6.784 0 0 0-2.952 3.489.76.76 0 0 1-.036.098A6.74 6.74 0 0 0 5.251 12a6.74 6.74 0 0 0 3.366 5.842l.009.005a6.704 6.704 0 0 0 2.18.798l.022.003a6.792 6.792 0 0 0 2.368-.004 6.704 6.704 0 0 0 2.205-.811 6.785 6.785 0 0 0 1.762-1.484l.009-.01.009-.01a6.743 6.743 0 0 0 1.18-2.066c.253-.707.39-1.469.39-2.263a6.74 6.74 0 0 0-.408-2.309Z",clipRule:"evenodd"}))});var n=a(7482),o=a(2842),c=a(5038),d=a(9733);function u(){let[e,t]=(0,s.useState)([]),[a,u]=(0,s.useState)(!0),[h,m]=(0,s.useState)(null),[g,p]=(0,s.useState)(!1),[x,f]=(0,s.useState)({}),{canManageRoles:y,canDeleteRoles:b}=(0,c.QT)(),[w,j]=(0,s.useState)({name:"",displayName:"",description:"",permissions:{}});(0,s.useEffect)(()=>{v(),N()},[]);let v=async()=>{try{let e=await d.roleService.getRoles();t(e),m(null)}catch(t){var e,a;console.error("Role fetch error:",t),(null==(e=t.message)?void 0:e.includes("Invalid token"))||(null==(a=t.message)?void 0:a.includes("TOKEN_INVALID"))?(m("Your session has expired. Please log in again."),setTimeout(()=>{window.location.href="/login"},2e3)):m(t.message||"Failed to fetch roles")}finally{u(!1)}},N=async()=>{try{let e=await d.roleService.getPermissionStructure();f(e);let t={};Object.keys(e).forEach(a=>{t[a]={},Object.keys(e[a].actions).forEach(e=>{t[a][e]=!1})}),j(e=>({...e,permissions:t}))}catch(e){console.error("Permission structure fetch error:",e)}},k=async()=>{if(!w.name||!w.displayName)return void m("Role name and display name are required");try{await d.roleService.createRole({name:w.name,displayName:w.displayName,description:w.description,permissions:w.permissions}),p(!1),j({name:"",displayName:"",description:"",permissions:{}}),await v(),m(null)}catch(e){m(e.message||"Failed to create role")}},A=async(e,t)=>{if(confirm('Are you sure you want to delete role "'.concat(t,'"?')))try{await d.roleService.deleteRole(e),await v(),m(null)}catch(e){m(e.message||"Failed to delete role")}};return a?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 py-8 px-2 sm:px-6",children:(0,r.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading roles..."})]})})}):(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50 py-8 px-2 sm:px-6",children:[(0,r.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-8 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-4xl font-black text-gray-900 mb-1 tracking-wider drop-shadow-sm",children:"Role Management"}),(0,r.jsx)("div",{className:"text-gray-600 text-base font-medium",children:"Create and manage user roles and permissions"})]}),(0,r.jsx)(c.Bk,{resource:"roles",action:"write",children:(0,r.jsxs)("button",{className:"bg-blue-600 hover:bg-blue-700 text-white font-bold px-5 py-2 rounded-lg shadow transition flex items-center gap-2 self-start sm:self-auto",onClick:()=>p(!0),children:[(0,r.jsx)(n.A,{className:"w-5 h-5"}),"Create New Role"]})})]}),h&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-lg mb-6",children:h}),(0,r.jsx)("div",{className:"bg-white rounded-xl shadow border border-blue-100 overflow-hidden",children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"py-3 px-4 text-left font-semibold whitespace-nowrap",children:"Role"}),(0,r.jsx)("th",{className:"py-3 px-4 text-left font-semibold whitespace-nowrap",children:"Type"}),(0,r.jsx)("th",{className:"py-3 px-4 text-left font-semibold whitespace-nowrap",children:"Description"}),(0,r.jsx)("th",{className:"py-3 px-4 text-left font-semibold whitespace-nowrap",children:"Permissions"}),(0,r.jsx)("th",{className:"py-3 px-4 text-left font-semibold whitespace-nowrap",children:"Actions"})]})}),(0,r.jsxs)("tbody",{children:[e.map(e=>(0,r.jsxs)("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[(0,r.jsxs)("td",{className:"py-4 px-4",children:[(0,r.jsx)("div",{className:"font-semibold text-gray-900",children:e.displayName}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:e.name})]}),(0,r.jsx)("td",{className:"py-4 px-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[e.isSystemRole?(0,r.jsx)(l,{className:"w-4 h-4 text-blue-600"}):(0,r.jsx)(i,{className:"w-4 h-4 text-gray-600"}),(0,r.jsx)("span",{className:"px-2 py-1 rounded text-xs font-semibold ".concat(e.isSystemRole?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:e.isSystemRole?"System":"Custom"})]})}),(0,r.jsx)("td",{className:"py-4 px-4",children:(0,r.jsx)("div",{className:"text-sm text-gray-600 max-w-xs truncate",children:e.description||"No description"})}),(0,r.jsx)("td",{className:"py-4 px-4",children:(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:[Object.keys(e.permissions||{}).length," resources configured"]})}),(0,r.jsx)("td",{className:"py-4 px-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{className:"p-2 text-blue-600 hover:bg-blue-50 rounded transition",title:"Edit Role",children:(0,r.jsx)(i,{className:"w-4 h-4"})}),!e.isSystemRole&&(0,r.jsx)(c.Bk,{resource:"roles",action:"delete",children:(0,r.jsx)("button",{className:"p-2 text-red-600 hover:bg-red-50 rounded transition",onClick:()=>A(e.id,e.displayName),title:"Delete Role",children:(0,r.jsx)(o.A,{className:"w-4 h-4"})})})]})})]},e.id)),0===e.length&&(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:5,className:"py-12 text-center text-gray-500",children:"No roles found. Create your first role to get started."})})]})]})})})]}),g&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Create New Role"}),(0,r.jsx)("p",{className:"text-gray-600 mt-1",children:"Define a custom role with specific permissions"})]}),(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role Name (Internal) *"}),(0,r.jsx)("input",{type:"text",value:w.name,onChange:e=>j(t=>({...t,name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., custom_analyst"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Display Name *"}),(0,r.jsx)("input",{type:"text",value:w.displayName,onChange:e=>j(t=>({...t,displayName:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Data Analyst"})]})]}),(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,r.jsx)("textarea",{value:w.description,onChange:e=>j(t=>({...t,description:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:"Describe what this role is for..."})]}),(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Permissions"}),(0,r.jsx)("div",{className:"space-y-6",children:Object.entries(x).map(e=>{let[t,a]=e;return(0,r.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,r.jsx)("div",{className:"flex items-center justify-between mb-3",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900",children:a.displayName}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:a.description})]})}),(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(a.actions).map(e=>{var a;let[s,l]=e;return(0,r.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,r.jsx)("input",{type:"checkbox",checked:(null==(a=w.permissions[t])?void 0:a[s])||!1,onChange:e=>{var a;return a=e.target.checked,void j(e=>({...e,permissions:{...e.permissions,[t]:{...e.permissions[t],[s]:a}}}))},className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,r.jsx)("span",{className:"text-sm text-gray-700",children:l})]},s)})})]},t)})})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-4 pt-6 border-t border-gray-200",children:[(0,r.jsx)("button",{onClick:()=>{p(!1),j({name:"",displayName:"",description:"",permissions:{}})},className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),(0,r.jsx)("button",{onClick:k,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Create Role"})]})]})]})})]})}},6681:(e,t,a)=>{"use strict";a.d(t,{h:()=>i});var r=a(4540),s=a(2115),l=a(7218);let i=()=>{let e=(0,r.wA)(),{user:t,organization:a,isAuthenticated:i,isLoading:n,error:o}=(0,r.d4)(e=>e.auth),c=(0,s.useCallback)(async t=>await e((0,l.Lx)(t)),[e]),d=(0,s.useCallback)(async t=>await e((0,l.d3)(t)),[e]),u=(0,s.useCallback)(async()=>await e((0,l.y4)()),[e]),h=(0,s.useCallback)(()=>{e((0,l.ET)())},[e]);return{user:t,organization:a,isAuthenticated:i,isLoading:n,error:o,login:c,register:d,logout:u,clearError:h,checkAuth:(0,s.useCallback)(async()=>await e((0,l.z)()),[e]),refreshToken:(0,s.useCallback)(async()=>await e((0,l.B3)()),[e])}}},7218:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>m,B3:()=>n,ET:()=>u,Lx:()=>l,d3:()=>i,y4:()=>o,z:()=>c});var r=a(1990),s=a(9959);let l=(0,r.zD)("auth/login",async(e,t)=>{let{rejectWithValue:a}=t;try{return await s.A.login(e)}catch(e){return a(e.message||"Login failed")}}),i=(0,r.zD)("auth/register",async(e,t)=>{let{rejectWithValue:a}=t;try{return await s.A.register(e)}catch(e){return a(e.message||"Registration failed")}}),n=(0,r.zD)("auth/refreshToken",async(e,t)=>{let{rejectWithValue:a}=t;try{return{token:await s.A.refreshToken()}}catch(e){return a(e.message||"Token refresh failed")}}),o=(0,r.zD)("auth/logout",async()=>{await s.A.logout()}),c=(0,r.zD)("auth/checkStatus",async(e,t)=>{let{rejectWithValue:a}=t;try{if(!s.A.isAuthenticated())throw Error("Not authenticated");let e=await s.A.ensureValidToken();if(!e)throw Error("Invalid token");let t=s.A.getUser(),a=s.A.getOrganization();return{user:t,organization:a,token:e}}catch(e){return a(e.message||"Authentication check failed")}}),d=(0,r.Z0)({name:"auth",initialState:{user:null,organization:null,token:null,isAuthenticated:!1,isLoading:!1,error:null},reducers:{clearError:e=>{e.error=null},setCredentials:(e,t)=>{e.user=t.payload.user,e.organization=t.payload.organization,e.token=t.payload.token,e.isAuthenticated=!0,e.error=null}},extraReducers:e=>{e.addCase(l.pending,e=>{e.isLoading=!0,e.error=null}).addCase(l.fulfilled,(e,t)=>{e.isLoading=!1,e.user=t.payload.user,e.organization=t.payload.organization,e.token=t.payload.token,e.isAuthenticated=!0,e.error=null}).addCase(l.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload,e.isAuthenticated=!1,e.user=null,e.organization=null,e.token=null}).addCase(i.pending,e=>{e.isLoading=!0,e.error=null}).addCase(i.fulfilled,e=>{e.isLoading=!1,e.error=null}).addCase(i.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload}).addCase(n.fulfilled,(e,t)=>{e.token=t.payload.token}).addCase(n.rejected,e=>{e.user=null,e.organization=null,e.token=null,e.isAuthenticated=!1}).addCase(c.fulfilled,(e,t)=>{e.user=t.payload.user,e.organization=t.payload.organization,e.token=t.payload.token,e.isAuthenticated=!0,e.error=null}).addCase(c.rejected,e=>{e.user=null,e.organization=null,e.token=null,e.isAuthenticated=!1}).addCase(o.fulfilled,e=>{e.user=null,e.organization=null,e.token=null,e.isAuthenticated=!1,e.error=null})}}),{clearError:u,setCredentials:h}=d.actions,m=d.reducer},7482:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});var r=a(2115);let s=r.forwardRef(function(e,t){let{title:a,titleId:s,...l}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":s},l),a?r.createElement("title",{id:s},a):null,r.createElement("path",{fillRule:"evenodd",d:"M12 3.75a.75.75 0 0 1 .75.75v6.75h6.75a.75.75 0 0 1 0 1.5h-6.75v6.75a.75.75 0 0 1-1.5 0v-6.75H4.5a.75.75 0 0 1 0-1.5h6.75V4.5a.75.75 0 0 1 .75-.75Z",clipRule:"evenodd"}))})},9733:(e,t,a)=>{"use strict";a.d(t,{roleService:()=>l});var r=a(1008);class s{getAuthHeaders(){let e=localStorage.getItem("auth_token");return{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}async handleAuthError(e){401===e.status?(console.warn("Authentication failed, redirecting to login"),window.location.href="/login"):403===e.status&&console.warn("Access forbidden - user lacks required permissions")}async getRoles(){let e=await fetch("".concat(this.API_BASE_URL,"/roles"),{headers:this.getAuthHeaders()});if(!e.ok)throw await this.handleAuthError(e),Error((await e.json().catch(()=>({}))).error||"Failed to fetch roles");let t=await e.json();return t.roles||t}async getRole(e){let t=await fetch("".concat(this.API_BASE_URL,"/roles/").concat(e),{headers:this.getAuthHeaders()});if(!t.ok)throw await this.handleAuthError(t),Error((await t.json().catch(()=>({}))).error||"Failed to fetch role");return(await t.json()).role}async createRole(e){let t=await fetch("".concat(this.API_BASE_URL,"/roles"),{method:"POST",headers:this.getAuthHeaders(),body:JSON.stringify(e)});if(!t.ok)throw await this.handleAuthError(t),Error((await t.json().catch(()=>({}))).error||"Failed to create role");let a=await t.json();return a.role||a}async updateRole(e,t){let a=await fetch("".concat(this.API_BASE_URL,"/roles/").concat(e),{method:"PUT",headers:this.getAuthHeaders(),body:JSON.stringify(t)});if(!a.ok)throw await this.handleAuthError(a),Error((await a.json().catch(()=>({}))).error||"Failed to update role");let r=await a.json();return r.role||r}async deleteRole(e){let t=await fetch("".concat(this.API_BASE_URL,"/roles/").concat(e),{method:"DELETE",headers:this.getAuthHeaders()});if(!t.ok)throw await this.handleAuthError(t),Error((await t.json().catch(()=>({}))).error||"Failed to delete role")}async getPermissionStructure(){let e=await fetch("".concat(this.API_BASE_URL,"/roles/system/permissions"),{headers:this.getAuthHeaders()});if(!e.ok)throw await this.handleAuthError(e),Error((await e.json().catch(()=>({}))).error||"Failed to fetch permission structure");let t=await e.json();return t.permissions||t}async getAvailableRoles(){let e=await fetch("".concat(this.API_BASE_URL,"/roles"),{headers:this.getAuthHeaders()});if(!e.ok)throw await this.handleAuthError(e),Error((await e.json().catch(()=>({}))).error||"Failed to fetch available roles");let t=await e.json();return t.roles||t}constructor(){this.API_BASE_URL=(0,r.h)()}}let l=new s},9959:(e,t,a)=>{"use strict";a.d(t,{A:()=>i,y:()=>l});let r=(0,a(1008).h)();class s{getAuthHeaders(){let e=this.getToken();return{"Content-Type":"application/json",...e&&{Authorization:"Bearer ".concat(e)}}}async login(e){let t=await fetch("".concat(r,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),a=await t.json();if(!t.ok)throw Error(a.error||"Login failed");return a.token&&(this.setToken(a.token),this.setUser(a.user),this.setOrganization(a.organization)),a}async register(e){let t=await fetch("".concat(r,"/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),a=await t.json();if(!t.ok)throw Error(a.error||"Registration failed");return a}async refreshToken(){let e=this.getToken();if(!e)throw Error("No token available for refresh");let t=await fetch("".concat(r,"/auth/refresh"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e})}),a=await t.json();if(!t.ok)throw Error(a.error||"Token refresh failed");return this.setToken(a.token),a.token}async logout(){try{this.getToken()&&await fetch("".concat(r,"/auth/logout"),{method:"POST",headers:this.getAuthHeaders()})}catch(e){console.warn("Logout API call failed:",e)}finally{localStorage.removeItem("auth_token"),localStorage.removeItem("auth_user"),localStorage.removeItem("auth_organization")}}getToken(){return localStorage.getItem("auth_token")}setToken(e){localStorage.setItem("auth_token",e)}getUser(){{let e=localStorage.getItem("auth_user");return e?JSON.parse(e):null}}setUser(e){localStorage.setItem("auth_user",JSON.stringify(e))}getOrganization(){{let e=localStorage.getItem("auth_organization");return e?JSON.parse(e):null}}setOrganization(e){localStorage.setItem("auth_organization",JSON.stringify(e))}isAuthenticated(){return!!this.getToken()}isTokenExpired(){let e=this.getToken();if(!e)return!0;try{let t=JSON.parse(atob(e.split(".")[1])),a=Date.now()/1e3;return t.exp<a}catch(e){return!0}}async ensureValidToken(){if(!this.isAuthenticated())return null;if(this.isTokenExpired())try{return await this.refreshToken()}catch(e){return localStorage.removeItem("auth_token"),localStorage.removeItem("auth_user"),localStorage.removeItem("auth_organization"),null}return this.getToken()}}let l=new s,i=l}},e=>{e.O(0,[635,441,964,977],()=>e(e.s=4015)),_N_E=e.O()}]);