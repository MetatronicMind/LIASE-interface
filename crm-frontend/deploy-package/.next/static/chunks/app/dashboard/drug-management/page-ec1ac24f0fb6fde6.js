(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[996],{1008:(e,t,r)=>{"use strict";r.d(t,{h:()=>l});let s="https://liase-backend-fpc8gsbrghgacdgx.centralindia-01.azurewebsites.net/api";console.log("API Configuration:",{NEXT_PUBLIC_API_URL:"https://liase-backend-fpc8gsbrghgacdgx.centralindia-01.azurewebsites.net/api",FINAL_API_URL:s});let a={BASE_URL:s},l=()=>(console.log("=== API BASE URL DEBUG ==="),console.log("Environment Variable NEXT_PUBLIC_API_URL:","https://liase-backend-fpc8gsbrghgacdgx.centralindia-01.azurewebsites.net/api"),console.log("Fallback URL:","https://liase-backend-fpc8gsbrghgacdgx.centralindia-01.azurewebsites.net/api"),console.log("Final API_CONFIG.BASE_URL:",a.BASE_URL),console.log("========================="),a.BASE_URL)},2783:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});var s=r(5155),a=r(2115),l=r(1008);function o(e){var t,r,o,n,i,c;let{jobId:d,onComplete:u}=e,[m,g]=(0,a.useState)(null),[h,x]=(0,a.useState)(""),[b,p]=(0,a.useState)(!1);if((0,a.useEffect)(()=>{if(!d)return;let e=null,t=0,r=2e3,s=!0,a=async()=>{if(s)try{let o=localStorage.getItem("auth_token"),n="".concat((0,l.h)(),"/drugs/jobs/").concat(d),i=new AbortController,c=setTimeout(()=>i.abort(),1e4),m=await fetch(n,{headers:{...o&&{Authorization:"Bearer ".concat(o)}},signal:i.signal});if(clearTimeout(c),m.ok){let s=await m.json();if(g(s),x(""),p(!1),t=0,r=2e3,"completed"===s.status||"failed"===s.status){e&&(clearInterval(e),e=null),u&&"completed"===s.status?u({message:s.message,results:s.results}):"failed"===s.status&&x(s.error||"Job failed to complete"),localStorage.getItem("activeJobId")===d&&(localStorage.removeItem("activeJobId"),localStorage.removeItem("showProgressTracker"));return}e&&clearInterval(e),e=setTimeout(a,r)}else{if(t++,404===m.status){x("Job not found. This may be an old job that has expired."),s=!1,localStorage.getItem("activeJobId")===d&&(localStorage.removeItem("activeJobId"),localStorage.removeItem("showProgressTracker")),e&&(clearInterval(e),e=null);return}if(429===m.status){x("Server is busy. Slowing down requests..."),p(!0);let t=m.headers.get("Retry-After"),s=t?1e3*parseInt(t):Math.max(3*r,3e4);r=Math.min(s,12e4),e&&clearInterval(e),e=setTimeout(a,r);return}if(503===m.status){x("Server is temporarily overloaded. Retrying with longer delays..."),p(!0),r=Math.min(4*r,18e4),e&&clearInterval(e),e=setTimeout(a,r);return}else 500===m.status?x("Server error occurred during processing. The job may still be running, please check back later."):x("Failed to fetch job status (".concat(m.status,"). Please try refreshing the page."));if(t>=3){x("Too many failed attempts. This may be an invalid or expired job."),s=!1,localStorage.getItem("activeJobId")===d&&(localStorage.removeItem("activeJobId"),localStorage.removeItem("showProgressTracker")),e&&(clearInterval(e),e=null);return}r=Math.min(1.5*r,1e4),p(!0),e&&clearInterval(e),e=setTimeout(a,r)}}catch(l){if(t++,"AbortError"===l.name?x("Request timeout - server may be overloaded. Retrying with longer intervals..."):x("Network error - unable to check job status. Please check your connection and try again."),t>=3){x("Too many failed attempts. This may be an invalid or expired job."),s=!1,localStorage.getItem("activeJobId")===d&&(localStorage.removeItem("activeJobId"),localStorage.removeItem("showProgressTracker")),e&&(clearInterval(e),e=null);return}r=Math.min(2*r,15e3),p(!0),e&&clearInterval(e),e=setTimeout(a,r)}};return a(),()=>{e&&(clearInterval(e),e=null)}},[d,u]),!d)return null;if(!m)return(0,s.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"}),(0,s.jsx)("div",{className:"text-blue-800",children:b?"Connecting to server...":"Loading job status..."})]}),h&&b&&(0,s.jsx)("div",{className:"text-yellow-700 text-xs mt-2",children:"Having trouble connecting, retrying..."})]});if(h&&!b)return(0,s.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)("div",{className:"text-red-600 font-medium",children:"Error"})}),(0,s.jsx)("div",{className:"text-red-700 text-sm mt-1",children:h})]});let v=(null==(t=m.metadata)?void 0:t.studiesFound)||0,y=(null==(r=m.results)?void 0:r.studiesCreated)||(null==(o=m.metadata)?void 0:o.studiesCreated)||0,j=(null==(n=m.metadata)?void 0:n.currentStudy)||0,f=(null==(i=m.metadata)?void 0:i.totalStudies)||0,N=(null==(c=m.metadata)?void 0:c.phase)||"starting";return(0,s.jsxs)("div",{className:"border rounded-lg p-4 ".concat((e=>{switch(e){case"completed":return"text-green-600 bg-green-50 border-green-200";case"failed":return"text-red-600 bg-red-50 border-red-200";case"started":case"running":return"text-blue-600 bg-blue-50 border-blue-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}})(m.status)),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsx)("h3",{className:"font-medium",children:"Discovery Progress"}),(0,s.jsx)("span",{className:"text-sm font-medium capitalize",children:m.status})]}),(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-3",children:(0,s.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-500 ease-out",style:{width:"".concat(m.progress,"%")}})}),(0,s.jsx)("div",{className:"mb-3 text-sm text-gray-700",children:(0,s.jsxs)("div",{className:"flex items-center",children:[("started"===m.status||"running"===m.status)&&(0,s.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-current mr-2"}),m.message]})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:"Progress"}),(0,s.jsxs)("div",{children:[m.currentStep," / ",m.totalSteps," (",m.progress,"%)"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:"Studies Found"}),(0,s.jsx)("div",{className:"text-blue-600",children:v})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:"Studies Created"}),(0,s.jsx)("div",{className:"text-green-600",children:y})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:"Phase"}),(0,s.jsx)("div",{className:"text-gray-600 capitalize",children:N.replace(/_/g," ")})]})]}),"creating_studies"===N&&f>0&&(0,s.jsx)("div",{className:"mt-3 text-sm text-gray-600",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-current mr-2"}),"Creating study ",j," of ",f,"..."]})}),"completed"===m.status&&(0,s.jsx)("div",{className:"mt-3 text-sm text-green-700",children:"✓ Discovery completed successfully!"}),"failed"===m.status&&(0,s.jsxs)("div",{className:"mt-3 text-sm text-red-700",children:["✗ Discovery failed: ",m.error||"Unknown error"]})]})}function n(){var e;let[t,r]=(0,a.useState)([]),[n,i]=(0,a.useState)([]),[c,d]=(0,a.useState)(!1),[u,m]=(0,a.useState)("existing"),[g,h]=(0,a.useState)(null),[x,b]=(0,a.useState)(""),[p,v]=(0,a.useState)(""),[y,j]=(0,a.useState)(""),[f,N]=(0,a.useState)("custom"),[S,w]=(0,a.useState)(""),[I,k]=(0,a.useState)(""),[C,T]=(0,a.useState)(!1),[P,A]=(0,a.useState)(new Set),[D,E]=(0,a.useState)(null),[R,_]=(0,a.useState)(!1);(0,a.useEffect)(()=>{{let e=localStorage.getItem("activeJobId"),t="true"===localStorage.getItem("showProgressTracker");if(e&&t){let t=localStorage.getItem("jobTimestamp"),r=Date.now();t&&r-parseInt(t)<36e5?(E(e),_(!0)):(localStorage.removeItem("activeJobId"),localStorage.removeItem("showProgressTracker"),localStorage.removeItem("jobTimestamp"))}}},[]);let[J,L]=(0,a.useState)(""),[F,U]=(0,a.useState)(""),[B,O]=(0,a.useState)(!1),z="".concat((0,l.h)(),"/drugs"),q=e=>{E(e),e?(localStorage.setItem("activeJobId",e),localStorage.setItem("jobTimestamp",Date.now().toString())):(localStorage.removeItem("activeJobId"),localStorage.removeItem("jobTimestamp"))},M=e=>{_(e),e?localStorage.setItem("showProgressTracker","true"):localStorage.removeItem("showProgressTracker")};(0,a.useEffect)(()=>{Y(),G(),W()},[]);let W=async()=>{try{let e=localStorage.getItem("auth_token"),t=await fetch("".concat(z,"/user-info"),{headers:{"Content-Type":"application/json",...e&&{Authorization:"Bearer ".concat(e)}}});if(t.ok){let e=await t.json();h(e.user)}}catch(e){console.error("Error fetching user info:",e)}},Y=async()=>{d(!0);try{let e=localStorage.getItem("auth_token"),t=await fetch(z,{headers:{"Content-Type":"application/json",...e&&{Authorization:"Bearer ".concat(e)}}});if(t.ok){let e=await t.json();r(e.drugs||[])}}catch(e){console.error("Error fetching drugs:",e)}finally{d(!1)}},G=async()=>{try{let e=localStorage.getItem("auth_token"),t=await fetch("".concat(z,"/search-configs"),{headers:{"Content-Type":"application/json",...e&&{Authorization:"Bearer ".concat(e)}}});if(t.ok){let e=await t.json();i(e.configs||[])}}catch(e){console.error("Error fetching search configs:",e)}},H=async()=>{if(!J.trim())return void alert("Please enter a search query.");O(!0);try{let e=localStorage.getItem("auth_token"),t=new URLSearchParams({query:J.trim(),sponsor:F.trim()||"",maxResults:"1000",includeAdverseEvents:"true",includeSafety:"true"}),r=await fetch("".concat(z,"/discover?").concat(t),{method:"GET",headers:{"Content-Type":"application/json",...e&&{Authorization:"Bearer ".concat(e)}}});if(r.ok){let e=await r.json();if(e.jobId)q(e.jobId),M(!0);else{let t=e.totalFound||0,r=e.studiesCreated||0,s="Discovery completed!\nFound ".concat(t," results");r>0&&(s+="\nCreated ".concat(r," studies with AI analysis")),alert(s)}Y(),G()}else{let e=await r.json().catch(()=>({}));console.error("Error running manual discovery:",e),alert("Error running discovery: ".concat(e.error||"Unknown error occurred"))}}catch(e){console.error("Error running manual discovery:",e),alert("Network error. Please check your connection and try again.")}finally{O(!1)}},Q=async(e,t)=>{A(t=>new Set(t).add(e));try{let s=localStorage.getItem("auth_token"),a=await fetch("".concat(z,"/search-configs/").concat(e,"/run"),{method:"POST",headers:{"Content-Type":"application/json",...s&&{Authorization:"Bearer ".concat(s)}}});if(a.ok||202===a.status){let s=await a.json();if(s.jobId)q(s.jobId),M(!0),A(t=>{let r=new Set(t);return r.delete(e),r});else{var r;let e=(null==(r=s.results)?void 0:r.totalFound)||0,a=s.studiesCreated||0,l=!0===s.aiInferenceCompleted?" (AI analysis completed)":!1===s.aiInferenceCompleted?" (AI analysis failed)":"",o='Search "'.concat(t,'" completed successfully!\nFound ').concat(e," results");a>0&&(o+="\nCreated ".concat(a," studies with detailed AI analysis")),o+=l,alert(o),G()}}else{let e=await a.json().catch(()=>({}));console.error("Error running configuration:",e),403===a.status?alert("Permission Error: ".concat(e.error||"You do not have permission to run this configuration.")):404===a.status?alert("Configuration not found. It may have been deleted."):alert("Error running search: ".concat(e.error||"Unknown error occurred"))}}catch(e){console.error("Error running search config:",e),alert("Network error. Please check your connection and try again.")}finally{A(t=>{let r=new Set(t);return r.delete(e),r})}},V=async()=>{if(!x.trim()||!p.trim())return void alert("Please enter both name and query.");T(!0);try{let e=localStorage.getItem("auth_token"),t=await fetch("".concat(z,"/search-configs"),{method:"POST",headers:{"Content-Type":"application/json",...e&&{Authorization:"Bearer ".concat(e)}},body:JSON.stringify({name:x.trim(),query:p.trim(),sponsor:y.trim()||"",frequency:f,maxResults:1e3,includeAdverseEvents:!0,includeSafety:!0,sendToExternalApi:!0,dateFrom:S&&S.trim()?S.trim():null,dateTo:I&&I.trim()?I.trim():null})});if(t.ok)alert("Search configuration saved successfully!"),b(""),v(""),j(""),N("custom"),w(""),k(""),G();else{let e=await t.json().catch(()=>({}));if(console.error("Full error response:",t.status,t.statusText,e),403===t.status)alert("Permission Error: ".concat(e.error||"You do not have permission to create drug search configurations. Please contact your administrator."));else if(401===t.status)alert("Authentication Error: Please log in again.");else if(400===t.status&&e.details){let t=e.details.map(e=>e.msg).join("\n");alert("Validation Error:\n".concat(t,"\n\nData sent: ").concat(JSON.stringify(e.receivedData,null,2)))}else alert("Error: ".concat(e.error||"Failed to save configuration"))}}catch(e){console.error("Error creating search config:",e),alert("Failed to save configuration")}finally{T(!1)}};return(0,s.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto py-6 px-4",children:(0,s.jsxs)("div",{className:"bg-white shadow rounded-lg",children:[(0,s.jsx)("div",{className:"border-b border-gray-200",children:(0,s.jsxs)("nav",{className:"-mb-px flex space-x-8 px-6",children:[(0,s.jsxs)("button",{onClick:()=>m("existing"),className:"py-4 px-1 border-b-2 font-medium text-sm ".concat("existing"===u?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"),children:["Existing Drugs (",t.length,")"]}),(0,s.jsxs)("button",{onClick:()=>m("searches"),className:"py-4 px-1 border-b-2 font-medium text-sm ".concat("searches"===u?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"),children:["Search Configurations (",n.length,")"]}),(0,s.jsx)("button",{onClick:()=>m("manual"),className:"py-4 px-1 border-b-2 font-medium text-sm ".concat("manual"===u?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"),children:"Manual Discovery"}),(0,s.jsx)("button",{onClick:()=>m("debug"),className:"py-4 px-1 border-b-2 font-medium text-sm ".concat("debug"===u?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"),children:"Debug Info"})]})}),R&&D&&(0,s.jsx)("div",{className:"p-6 border-b border-gray-100",children:(0,s.jsx)(o,{jobId:D,onComplete:e=>{var t,r;M(!1),q(null);let s=(null==e?void 0:e.message)||"Job completed successfully!",a=(null==e||null==(t=e.results)?void 0:t.studiesCreated)||0,l=(null==e||null==(r=e.results)?void 0:r.totalFound)||0,o=s;l>0&&(o="Discovery completed!\nFound ".concat(l," studies"),a>0&&(o+="\nCreated ".concat(a," study records with AI analysis"))),alert(o),Y(),G()}})}),(0,s.jsxs)("div",{className:"p-6",children:["existing"===u&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Existing Drugs"}),c?(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,s.jsx)("p",{className:"mt-2 text-gray-600",children:"Loading drugs..."})]}):(0,s.jsx)("div",{className:"text-center py-8 text-gray-500",children:0===t.length?"No drugs found.":"".concat(t.length," drugs loaded.")})]}),"searches"===u&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Search Configurations"}),(0,s.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[(0,s.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Create New Search Configuration"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsx)("input",{type:"text",value:x,onChange:e=>b(e.target.value),placeholder:"Configuration Name",className:"w-full px-3 py-2 border border-gray-300 rounded-md"}),(0,s.jsx)("input",{type:"text",value:p,onChange:e=>v(e.target.value),placeholder:"Query (Drug Name)",className:"w-full px-3 py-2 border border-gray-300 rounded-md"}),(0,s.jsx)("input",{type:"text",value:y,onChange:e=>j(e.target.value),placeholder:"Sponsor (Optional)",className:"w-full px-3 py-2 border border-gray-300 rounded-md"}),(0,s.jsxs)("select",{value:f,onChange:e=>N(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,s.jsx)("option",{value:"custom",children:"Custom (Manual/Date Range)"}),(0,s.jsx)("option",{value:"daily",children:"Daily (Last 24 hours)"}),(0,s.jsx)("option",{value:"weekly",children:"Weekly (Last 7 days)"}),(0,s.jsx)("option",{value:"monthly",children:"Monthly (Last 30 days)"})]}),"custom"===f&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date From (Optional)"}),(0,s.jsx)("input",{type:"date",onChange:e=>{let t=e.target.value;t?w(t.replace(/-/g,"/")):w("")},className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date To (Optional)"}),(0,s.jsx)("input",{type:"date",onChange:e=>{let t=e.target.value;t?k(t.replace(/-/g,"/")):k("")},className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]})]}),"custom"!==f&&(0,s.jsx)("div",{className:"md:col-span-2",children:(0,s.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3",children:(0,s.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,s.jsxs)("strong",{children:[f.charAt(0).toUpperCase()+f.slice(1)," Search:"]}),"daily"===f&&" Will search articles from the last 24 hours","weekly"===f&&" Will search articles from the last 7 days","monthly"===f&&" Will search articles from the last 30 days"]})})})]}),(0,s.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,s.jsx)("button",{onClick:V,disabled:C||!x.trim()||!p.trim(),className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50",children:C?"Saving...":"Save Configuration"}),(0,s.jsx)("button",{onClick:async()=>{let e=localStorage.getItem("auth_token"),t=await fetch("".concat(z,"/search-configs/debug"),{method:"POST",headers:{"Content-Type":"application/json",...e&&{Authorization:"Bearer ".concat(e)}},body:JSON.stringify({name:x.trim(),query:p.trim(),sponsor:y.trim()||"",frequency:f,maxResults:1e3,includeAdverseEvents:!0,includeSafety:!0,sendToExternalApi:!0,dateFrom:S&&S.trim()?S.trim():null,dateTo:I&&I.trim()?I.trim():null})}),r=await t.json();console.log("Debug result:",r),alert("Debug result: ".concat(JSON.stringify(r,null,2)))},className:"bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700",children:"Debug"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Your Search Configurations"}),0===n.length?(0,s.jsx)("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:(0,s.jsx)("p",{className:"text-gray-600",children:"No search configurations yet. Create one above to start automatic drug discovery."})}):(0,s.jsx)("div",{className:"space-y-4",children:n.map(e=>(0,s.jsx)("div",{className:"border rounded-lg p-4 bg-white",children:(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h4",{className:"font-medium",children:e.name}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["Query: ",e.query]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["Frequency: ",e.frequency]}),e.sponsor&&(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["Sponsor: ",e.sponsor]}),(0,s.jsxs)("div",{className:"mt-2 flex flex-wrap gap-4 text-xs text-gray-500",children:[(0,s.jsxs)("span",{children:["Total Runs: ",e.totalRuns]}),(0,s.jsxs)("span",{children:["Last Result: ",e.lastResultCount," items"]}),e.lastRunAt&&(0,s.jsxs)("span",{children:["Last Run: ",new Date(e.lastRunAt).toLocaleDateString()]}),e.nextRunAt&&"manual"!==e.frequency&&(0,s.jsxs)("span",{children:["Next Run: ",new Date(e.nextRunAt).toLocaleDateString()]})]})]}),(0,s.jsx)("div",{className:"ml-4",children:(0,s.jsx)("button",{onClick:()=>Q(e.id,e.name),disabled:P.has(e.id),className:"px-4 py-2 text-sm font-medium rounded-md ".concat(P.has(e.id)?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"),children:P.has(e.id)?(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Running..."]}):"Run Now"})})]})},e.id))})]})]}),"manual"===u&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Manual Drug Discovery"}),(0,s.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg mb-6",children:[(0,s.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Run One-Time Discovery"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Perform a one-time drug discovery search with AI analysis and study creation."}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Query *"}),(0,s.jsx)("input",{type:"text",value:J,onChange:e=>L(e.target.value),placeholder:"e.g., aspirin, hypertension, drug name...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:B})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sponsor (Optional)"}),(0,s.jsx)("input",{type:"text",value:F,onChange:e=>U(e.target.value),placeholder:"e.g., Pfizer, GSK, Bristol Myers...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:B})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"text-sm text-gray-500",children:[(0,s.jsx)("p",{children:"• Searches PubMed for relevant studies"}),(0,s.jsx)("p",{children:"• Processes results with AI inference"}),(0,s.jsx)("p",{children:"• Creates detailed study records"}),(0,s.jsx)("p",{children:"• Includes progress tracking with failover"})]}),(0,s.jsx)("button",{onClick:H,disabled:B||!J.trim(),className:"px-6 py-3 font-medium rounded-md ".concat(B||!J.trim()?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"),children:B?(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Starting Discovery..."]}):"Start Discovery"})]})]}),(0,s.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,s.jsx)("h4",{className:"font-medium text-blue-900 mb-2",children:"How Manual Discovery Works"}),(0,s.jsxs)("div",{className:"text-sm text-blue-800",children:[(0,s.jsx)("p",{className:"mb-2",children:"Manual discovery allows you to run a one-time search without creating a saved configuration:"}),(0,s.jsxs)("ol",{className:"list-decimal list-inside space-y-1 ml-4",children:[(0,s.jsx)("li",{children:"Enter your search query (drug name, condition, etc.)"}),(0,s.jsx)("li",{children:"Optionally specify a sponsor to filter results"}),(0,s.jsx)("li",{children:'Click "Start Discovery" to begin the process'}),(0,s.jsx)("li",{children:"Watch real-time progress as studies are found and processed"}),(0,s.jsx)("li",{children:"AI analysis creates detailed study records automatically"})]}),(0,s.jsx)("p",{className:"mt-2 font-medium",children:"The system includes automatic failover to ensure reliable AI processing even if some endpoints are down."})]})]})]}),"debug"===u&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Debug Information"}),(0,s.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,s.jsx)("h3",{className:"text-lg font-medium mb-4",children:"User Authentication & Permissions"}),g?(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"User ID:"})," ",g.id]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Username:"})," ",g.username]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Role:"})," ",g.role]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Has Write Permission:"})," ",g.hasWritePermission?"✅ Yes":"❌ No"]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Has Create Permission:"})," ",g.hasCreatePermission?"✅ Yes":"❌ No"]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("strong",{children:"All Permissions:"}),(0,s.jsx)("pre",{className:"mt-2 p-2 bg-white border rounded text-xs overflow-auto",children:JSON.stringify(g.permissions,null,2)})]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("strong",{children:"Auth Token Preview:"}),(0,s.jsx)("p",{className:"text-xs text-gray-600",children:localStorage.getItem("auth_token")?"".concat(null==(e=localStorage.getItem("auth_token"))?void 0:e.substring(0,20),"..."):"No token found"})]})]}):(0,s.jsx)("p",{className:"text-gray-600",children:"Loading user information..."})]}),(0,s.jsxs)("div",{className:"bg-yellow-50 p-4 rounded-lg mt-6",children:[(0,s.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Job Tracking Debug"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Active Job ID:"})," ",D||"None"]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Show Progress Tracker:"})," ",R?"✅ Yes":"❌ No"]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Stored Job ID:"})," ",localStorage.getItem("activeJobId")||"None"]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Stored Show Tracker:"})," ",localStorage.getItem("showProgressTracker")||"None"]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Job Timestamp:"})," ",localStorage.getItem("jobTimestamp")?new Date(parseInt(localStorage.getItem("jobTimestamp")||"0")).toLocaleString():"None"]}),(0,s.jsxs)("div",{className:"mt-4 pt-4 border-t border-yellow-200",children:[(0,s.jsx)("button",{onClick:()=>{E(null),_(!1),localStorage.removeItem("activeJobId"),localStorage.removeItem("showProgressTracker"),localStorage.removeItem("jobTimestamp"),alert("Cleared all job tracking data from localStorage")},className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 text-sm",children:"Clear Stale Job Data"}),(0,s.jsx)("p",{className:"text-xs text-gray-600 mt-2",children:"Use this button if you're experiencing issues with stuck progress trackers or old job IDs"})]})]})]})]})]})]})})})}},4166:(e,t,r)=>{Promise.resolve().then(r.bind(r,2783))}},e=>{e.O(0,[441,964,977],()=>e(e.s=4166)),_N_E=e.O()}]);