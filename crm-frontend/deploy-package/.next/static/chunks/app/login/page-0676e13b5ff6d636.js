(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{1008:(e,t,a)=>{"use strict";a.d(t,{h:()=>s});let r="https://liase-backend-fpc8gsbrghgacdgx.centralindia-01.azurewebsites.net/api";console.log("API Configuration:",{NEXT_PUBLIC_API_URL:"https://liase-backend-fpc8gsbrghgacdgx.centralindia-01.azurewebsites.net/api",FINAL_API_URL:r});let n={BASE_URL:r},s=()=>(console.log("=== API BASE URL DEBUG ==="),console.log("Environment Variable NEXT_PUBLIC_API_URL:","https://liase-backend-fpc8gsbrghgacdgx.centralindia-01.azurewebsites.net/api"),console.log("Fallback URL:","https://liase-backend-fpc8gsbrghgacdgx.centralindia-01.azurewebsites.net/api"),console.log("Final API_CONFIG.BASE_URL:",n.BASE_URL),console.log("========================="),n.BASE_URL)},4318:()=>{},5695:(e,t,a)=>{"use strict";var r=a(8999);a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}})},6681:(e,t,a)=>{"use strict";a.d(t,{h:()=>l});var r=a(4540),n=a(2115),s=a(7218);let l=()=>{let e=(0,r.wA)(),{user:t,organization:a,isAuthenticated:l,isLoading:i,error:o}=(0,r.d4)(e=>e.auth),d=(0,n.useCallback)(async t=>await e((0,s.Lx)(t)),[e]),c=(0,n.useCallback)(async t=>await e((0,s.d3)(t)),[e]),u=(0,n.useCallback)(async()=>await e((0,s.y4)()),[e]),h=(0,n.useCallback)(()=>{e((0,s.ET)())},[e]);return{user:t,organization:a,isAuthenticated:l,isLoading:i,error:o,login:d,register:c,logout:u,clearError:h,checkAuth:(0,n.useCallback)(async()=>await e((0,s.z)()),[e]),refreshToken:(0,n.useCallback)(async()=>await e((0,s.B3)()),[e])}}},7218:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>g,B3:()=>i,ET:()=>u,Lx:()=>s,d3:()=>l,y4:()=>o,z:()=>d});var r=a(1990),n=a(9959);let s=(0,r.zD)("auth/login",async(e,t)=>{let{rejectWithValue:a}=t;try{return await n.A.login(e)}catch(e){return a(e.message||"Login failed")}}),l=(0,r.zD)("auth/register",async(e,t)=>{let{rejectWithValue:a}=t;try{return await n.A.register(e)}catch(e){return a(e.message||"Registration failed")}}),i=(0,r.zD)("auth/refreshToken",async(e,t)=>{let{rejectWithValue:a}=t;try{return{token:await n.A.refreshToken()}}catch(e){return a(e.message||"Token refresh failed")}}),o=(0,r.zD)("auth/logout",async()=>{await n.A.logout()}),d=(0,r.zD)("auth/checkStatus",async(e,t)=>{let{rejectWithValue:a}=t;try{if(!n.A.isAuthenticated())throw Error("Not authenticated");let e=await n.A.ensureValidToken();if(!e)throw Error("Invalid token");let t=n.A.getUser(),a=n.A.getOrganization();return{user:t,organization:a,token:e}}catch(e){return a(e.message||"Authentication check failed")}}),c=(0,r.Z0)({name:"auth",initialState:{user:null,organization:null,token:null,isAuthenticated:!1,isLoading:!1,error:null},reducers:{clearError:e=>{e.error=null},setCredentials:(e,t)=>{e.user=t.payload.user,e.organization=t.payload.organization,e.token=t.payload.token,e.isAuthenticated=!0,e.error=null}},extraReducers:e=>{e.addCase(s.pending,e=>{e.isLoading=!0,e.error=null}).addCase(s.fulfilled,(e,t)=>{e.isLoading=!1,e.user=t.payload.user,e.organization=t.payload.organization,e.token=t.payload.token,e.isAuthenticated=!0,e.error=null}).addCase(s.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload,e.isAuthenticated=!1,e.user=null,e.organization=null,e.token=null}).addCase(l.pending,e=>{e.isLoading=!0,e.error=null}).addCase(l.fulfilled,e=>{e.isLoading=!1,e.error=null}).addCase(l.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload}).addCase(i.fulfilled,(e,t)=>{e.token=t.payload.token}).addCase(i.rejected,e=>{e.user=null,e.organization=null,e.token=null,e.isAuthenticated=!1}).addCase(d.fulfilled,(e,t)=>{e.user=t.payload.user,e.organization=t.payload.organization,e.token=t.payload.token,e.isAuthenticated=!0,e.error=null}).addCase(d.rejected,e=>{e.user=null,e.organization=null,e.token=null,e.isAuthenticated=!1}).addCase(o.fulfilled,e=>{e.user=null,e.organization=null,e.token=null,e.isAuthenticated=!1,e.error=null})}}),{clearError:u,setCredentials:h}=c.actions,g=c.reducer},8105:(e,t,a)=>{Promise.resolve().then(a.bind(a,9690))},9690:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var r=a(5155);a(4318);var n=a(2115),s=a(5695),l=a(6681);function i(){let[e,t]=(0,n.useState)(""),[a,i]=(0,n.useState)(""),[o,d]=(0,n.useState)("username"),c=(0,s.useRouter)(),{login:u,isLoading:h,error:g,clearError:m,isAuthenticated:p}=(0,l.h)();(0,n.useEffect)(()=>{p&&c.push("/dashboard")},[p,c]),(0,n.useEffect)(()=>{g&&m()},[e,a]);let x=async t=>{if(t.preventDefault(),!e||!a)return;let r=/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?{email:e,password:a}:{username:e,password:a};try{let e=await u(r);"fulfilled"===e.meta.requestStatus&&c.push("/dashboard")}catch(e){console.error("Login failed:",e)}};return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-[linear-gradient(135deg,_#2584eb_0%,_#4fc3f7_100%)] px-4 py-10",children:(0,r.jsx)("div",{className:"w-full max-w-md",children:(0,r.jsxs)("form",{onSubmit:x,className:"bg-white p-14 rounded-3xl shadow-[0_8px_32px_0_rgba(37,99,235,0.18)] border border-blue-100 w-full max-w-md",children:[(0,r.jsxs)("div",{className:"text-center mb-10",children:[(0,r.jsx)("h1",{className:"text-5xl font-black text-primary mb-2 tracking-wider drop-shadow-sm",children:"LIASE"}),(0,r.jsx)("p",{className:"text-gray-500 text-lg mb-0 font-medium",children:"Literature Automation and Segregation"})]}),(0,r.jsxs)("div",{className:"mb-7",children:[(0,r.jsx)("label",{className:"block mb-2 font-bold text-gray-800",children:"Username or Email"}),(0,r.jsx)("input",{type:"text",className:"w-full border border-gray-300 rounded-lg px-4 py-2.5 focus:outline-none focus:border-primary text-base transition bg-white text-black",value:e,onChange:e=>t(e.target.value),required:!0,autoComplete:"username",placeholder:"Enter username or email"})]}),(0,r.jsxs)("div",{className:"mb-7",children:[(0,r.jsx)("label",{className:"block mb-2 font-bold text-gray-800",children:"Password"}),(0,r.jsx)("input",{type:"password",className:"w-full border border-gray-300 rounded-lg px-4 py-2.5 focus:outline-none focus:border-primary text-base transition bg-white text-black",value:a,onChange:e=>i(e.target.value),required:!0,autoComplete:"current-password"}),(0,r.jsx)("small",{className:"text-xs text-gray-400 block mt-1",children:"Minimum 6 characters required"})]}),g&&(0,r.jsx)("div",{className:"mb-5 text-red-600 text-center font-semibold",children:g}),(0,r.jsx)("button",{type:"submit",disabled:h||!e||!a,className:"w-full bg-primary text-white py-3 rounded-lg font-bold text-lg shadow-md hover:bg-primary-dark transition mb-8 tracking-wide disabled:opacity-50 disabled:cursor-not-allowed",children:h?"Signing In...":"Sign In"}),(0,r.jsx)("div",{className:"text-center mb-6",children:(0,r.jsxs)("p",{className:"text-gray-600",children:["Don't have an organization?"," ",(0,r.jsx)("a",{href:"/register",className:"text-primary font-semibold hover:underline",children:"Create one here"})]})}),(0,r.jsx)("hr",{className:"my-1 border-gray-200"}),(0,r.jsxs)("div",{className:"demo-credentials text-center",children:[(0,r.jsx)("div",{className:"font-bold text-gray-700 mb-3 text-base",children:"Demo Credentials:"}),(0,r.jsxs)("div",{className:"credentials-list space-y-1",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-primary font-bold",children:"Admin:"})," ",(0,r.jsx)("span",{className:"text-gray-700",children:"admin"})," ",(0,r.jsx)("span",{className:"text-gray-400",children:"/"})," ",(0,r.jsx)("span",{className:"text-gray-700",children:"Admin123!"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-primary font-bold",children:"Pharmacovigilance:"})," ",(0,r.jsx)("span",{className:"text-gray-700",children:"pv_user1"})," ",(0,r.jsx)("span",{className:"text-gray-400",children:"/"})," ",(0,r.jsx)("span",{className:"text-gray-700",children:"Pharma123!"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-primary font-bold",children:"Sponsor/Auditor:"})," ",(0,r.jsx)("span",{className:"text-gray-700",children:"auditor"})," ",(0,r.jsx)("span",{className:"text-gray-400",children:"/"})," ",(0,r.jsx)("span",{className:"text-gray-700",children:"Audit123!"})]})]})]})]})})})}},9959:(e,t,a)=>{"use strict";a.d(t,{A:()=>l,y:()=>s});let r=(0,a(1008).h)();class n{getAuthHeaders(){let e=this.getToken();return{"Content-Type":"application/json",...e&&{Authorization:"Bearer ".concat(e)}}}async login(e){let t=await fetch("".concat(r,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),a=await t.json();if(!t.ok)throw Error(a.error||"Login failed");return a.token&&(this.setToken(a.token),this.setUser(a.user),this.setOrganization(a.organization)),a}async register(e){let t=await fetch("".concat(r,"/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),a=await t.json();if(!t.ok)throw Error(a.error||"Registration failed");return a}async refreshToken(){let e=this.getToken();if(!e)throw Error("No token available for refresh");let t=await fetch("".concat(r,"/auth/refresh"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e})}),a=await t.json();if(!t.ok)throw Error(a.error||"Token refresh failed");return this.setToken(a.token),a.token}async logout(){try{this.getToken()&&await fetch("".concat(r,"/auth/logout"),{method:"POST",headers:this.getAuthHeaders()})}catch(e){console.warn("Logout API call failed:",e)}finally{localStorage.removeItem("auth_token"),localStorage.removeItem("auth_user"),localStorage.removeItem("auth_organization")}}getToken(){return localStorage.getItem("auth_token")}setToken(e){localStorage.setItem("auth_token",e)}getUser(){{let e=localStorage.getItem("auth_user");return e?JSON.parse(e):null}}setUser(e){localStorage.setItem("auth_user",JSON.stringify(e))}getOrganization(){{let e=localStorage.getItem("auth_organization");return e?JSON.parse(e):null}}setOrganization(e){localStorage.setItem("auth_organization",JSON.stringify(e))}isAuthenticated(){return!!this.getToken()}isTokenExpired(){let e=this.getToken();if(!e)return!0;try{let t=JSON.parse(atob(e.split(".")[1])),a=Date.now()/1e3;return t.exp<a}catch(e){return!0}}async ensureValidToken(){if(!this.isAuthenticated())return null;if(this.isTokenExpired())try{return await this.refreshToken()}catch(e){return localStorage.removeItem("auth_token"),localStorage.removeItem("auth_user"),localStorage.removeItem("auth_organization"),null}return this.getToken()}}let s=new n,l=s}},e=>{e.O(0,[12,635,441,964,977],()=>e(e.s=8105)),_N_E=e.O()}]);