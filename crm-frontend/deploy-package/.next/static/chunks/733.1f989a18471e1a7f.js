"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[733],{9733:(t,e,r)=>{r.d(e,{roleService:()=>s});var a=r(1008);class o{getAuthHeaders(){let t=localStorage.getItem("auth_token");return{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}}async handleAuthError(t){401===t.status?(console.warn("Authentication failed, redirecting to login"),window.location.href="/login"):403===t.status&&console.warn("Access forbidden - user lacks required permissions")}async getRoles(){let t=await fetch("".concat(this.API_BASE_URL,"/roles"),{headers:this.getAuthHeaders()});if(!t.ok)throw await this.handleAuthError(t),Error((await t.json().catch(()=>({}))).error||"Failed to fetch roles");let e=await t.json();return e.roles||e}async getRole(t){let e=await fetch("".concat(this.API_BASE_URL,"/roles/").concat(t),{headers:this.getAuthHeaders()});if(!e.ok)throw await this.handleAuthError(e),Error((await e.json().catch(()=>({}))).error||"Failed to fetch role");return(await e.json()).role}async createRole(t){let e=await fetch("".concat(this.API_BASE_URL,"/roles"),{method:"POST",headers:this.getAuthHeaders(),body:JSON.stringify(t)});if(!e.ok)throw await this.handleAuthError(e),Error((await e.json().catch(()=>({}))).error||"Failed to create role");let r=await e.json();return r.role||r}async updateRole(t,e){let r=await fetch("".concat(this.API_BASE_URL,"/roles/").concat(t),{method:"PUT",headers:this.getAuthHeaders(),body:JSON.stringify(e)});if(!r.ok)throw await this.handleAuthError(r),Error((await r.json().catch(()=>({}))).error||"Failed to update role");let a=await r.json();return a.role||a}async deleteRole(t){let e=await fetch("".concat(this.API_BASE_URL,"/roles/").concat(t),{method:"DELETE",headers:this.getAuthHeaders()});if(!e.ok)throw await this.handleAuthError(e),Error((await e.json().catch(()=>({}))).error||"Failed to delete role")}async getPermissionStructure(){let t=await fetch("".concat(this.API_BASE_URL,"/roles/system/permissions"),{headers:this.getAuthHeaders()});if(!t.ok)throw await this.handleAuthError(t),Error((await t.json().catch(()=>({}))).error||"Failed to fetch permission structure");let e=await t.json();return e.permissions||e}async getAvailableRoles(){let t=await fetch("".concat(this.API_BASE_URL,"/roles"),{headers:this.getAuthHeaders()});if(!t.ok)throw await this.handleAuthError(t),Error((await t.json().catch(()=>({}))).error||"Failed to fetch available roles");let e=await t.json();return e.roles||e}constructor(){this.API_BASE_URL=(0,a.h)()}}let s=new o}}]);